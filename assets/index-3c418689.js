(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function a(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(n){if(n.ep)return;n.ep=!0;const c=a(n);fetch(n.href,c)}})();var r=new BMapGL.Map("allmap");r.centerAndZoom(new BMapGL.Point(116.40396298757886,39.91511908708907),5);r.enableScrollWheelZoom(!0);r.setMapType(BMAP_EARTH_MAP);const F=.621371192237;var K=new BMapGL.Geocoder;const d=document.querySelector("#latlngs"),Z=document.querySelector("#drawLine"),D=document.querySelector("#distanceHaversine"),R=document.querySelector("#distanceVincenty"),W=document.querySelector("#clear");let o=[];var j=new BMapGL.Autocomplete({input:"suggestId",location:r});let l="";j.addEventListener("onconfirm",function(e){var t=e.item.value;l="",l=l+(t.city?t.city:""),l=l+(t.district?"-"+t.district:""),l=l+(t.street?"-"+t.street:""),l=l+(t.business?"-"+t.business:""),l=l+(t.streetNumber?"-"+t.streetNumber:""),X(l)});j.addEventListener("onhighlight",function(e){e.fromitem.value,console.log("value",e.fromitem)});function z(e){const t=document.querySelector("#complete");(t==null?void 0:t.checked)===!0&&(r.centerAndZoom(e,12),r.addOverlay(new BMapGL.Marker(e)))}r.addEventListener("click",function(e){o.length>=2&&C();var t=new BMapGL.Marker(new BMapGL.Point(e.latlng.lng,e.latlng.lat));r.addOverlay(t),z(e.latlng),Y(e.latlng)});const X=e=>{let t={};return K.getPoint(e,function(a){if(a){var s=new BMapGL.LocalSearch(r,{onSearchComplete:()=>{console.log("point",a),z(a)}});s.search(l);const n={addname:e,...a};o.length>=2&&C(),o.push(n),U(n),t=a}else alert("您选择的地址没有解析到结果！")}),t},Y=e=>{K.getLocation(e,function(t){const a=t.addressComponents;let s="";s=s+(a.province?a.province:""),s=s+(a.city?"-"+a.city:""),s=s+(a.district?"-"+a.district:""),s=s+(a.street?"-"+a.street:""),s=s+(a.streetNumber?"-"+a.streetNumber:"");const n={addname:s||"未知区域",...e};o.push(n),U(n)})},U=e=>{if(d)if(e){const t=`${e.addname}<br/>经度：${e.lng}，<br/>纬度：${e.lat}`;d.innerHTML+=`<p>${t}</p><hr/>`}else d.innerHTML=""},C=()=>{U(),o=[],r.clearOverlays(),$=!1,T=!1},x=()=>{var a,s,n,c;if(o.length===2){var e=[new BMapGL.Point((a=o[0])==null?void 0:a.lng,(s=o[0])==null?void 0:s.lat),new BMapGL.Point((n=o[1])==null?void 0:n.lng,(c=o[1])==null?void 0:c.lat)],t=new BMapGL.Polyline(e,{clip:!1,geodesic:!0,strokeWeight:3,visible:!0});r.addOverlay(t)}else console.log("请将点位添加至2个")};Z&&Z.addEventListener("click",x);D&&D.addEventListener("click",tt);R&&R.addEventListener("click",et);let T=!1,$=!1;function tt(){var e,t,a,s;if(o.length===2){if(!T){let n=(e=o[0])==null?void 0:e.lng,c=(t=o[1])==null?void 0:t.lng,u=(a=o[0])==null?void 0:a.lat,b=(s=o[1])==null?void 0:s.lat;const B=6371,f=(b-u)*(Math.PI/180),h=(c-n)*(Math.PI/180),L=Math.sin(f/2)*Math.sin(f/2)+Math.cos(u*(Math.PI/180))*Math.cos(b*(Math.PI/180))*Math.sin(h/2)*Math.sin(h/2),S=2*Math.atan2(Math.sqrt(L),Math.sqrt(1-L)),g=B*S;console.log("distance",g),d&&(d.innerHTML+=`<p>${g}公里</p>`,d.innerHTML+=`<p>${g*F}英里</p><hr/>`),T=!0}}else console.log("请将点位添加至2个")}function et(){var e,t,a,s;if(o.length!==2){console.log("请将点位添加至2个");return}if(!$){let n=(e=o[0])==null?void 0:e.lng,c=(t=o[1])==null?void 0:t.lng,u=(a=o[0])==null?void 0:a.lat,b=(s=o[1])==null?void 0:s.lat;const B=6378137,f=6356752314245e-6,h=1/298.257223563,L=(c-n)*(Math.PI/180),S=Math.atan((1-h)*Math.tan(u*(Math.PI/180))),g=Math.atan((1-h)*Math.tan(b*(Math.PI/180))),w=Math.sin(S),q=Math.cos(S),G=Math.sin(g),p=Math.cos(g);let y=L,V,_=100,H,A,m,v,I,O,P,i,E;do{if(H=Math.sin(y),A=Math.cos(y),m=Math.sqrt(p*H*(p*H)+(q*G-w*p*A)*(q*G-w*p*A)),m===0)return 0;if(v=w*G+q*p*A,I=Math.atan2(m,v),O=q*p*H/m,P=1-O*O,i=v-2*w*G/P,E=h/16*P*(4+h*(4-3*P)),V=y,y=L+(1-E)*h*O*(I+E*m*(i+E*v*(-1+2*i*i))),_--,_===0)return NaN}while(Math.abs(y-V)>1e-12);const M=P*(B*B-f*f)/(f*f),J=1+M/16384*(4096+M*(-768+M*(320-175*M))),N=M/1024*(256+M*(-128+M*(74-47*M))),Q=N*m*(i+N/4*(v*(-1+2*i*i)-N/6*i*(-3+4*m*m)*(-3+4*i*i))),k=f*J*(I-Q)/1e3;d&&(d.innerHTML+=`<p>${k}公里</p>`,d.innerHTML+=`<p>${k*F}英里</p><hr/>`),$=!0}}W&&W.addEventListener("click",C);
