(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function a(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerPolicy&&(c.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?c.credentials="include":t.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(t){if(t.ep)return;t.ep=!0;const c=a(t);fetch(t.href,c)}})();var i=new BMapGL.Map("allmap");i.centerAndZoom(new BMapGL.Point(116.40396298757886,39.91511908708907),5);i.enableScrollWheelZoom(!0);i.setMapType(BMAP_EARTH_MAP);var K=new BMapGLLib.DistanceTool(i);const j=.621371192237;var z=new BMapGL.Geocoder;const f=document.querySelector("#latlngs"),_=document.querySelector("#drawLine"),D=document.querySelector("#distanceHaversine"),Z=document.querySelector("#distanceVincenty"),R=document.querySelector("#clear"),g=document.querySelector("#unit"),W=document.querySelector("#distanceToolOpen"),F=document.querySelector("#distanceToolClose");let s=[];var Y=new BMapGL.Autocomplete({input:"suggestId",location:i});let l="";Y.addEventListener("onconfirm",function(n){var e=n.item.value;l="",l=l+(e.city?e.city:""),l=l+(e.district?"-"+e.district:""),l=l+(e.street?"-"+e.street:""),l=l+(e.business?"-"+e.business:""),l=l+(e.streetNumber?"-"+e.streetNumber:""),x(l)});function J(n){const e=document.querySelector("#complete");(e==null?void 0:e.checked)===!0&&i.centerAndZoom(n,12),i.addOverlay(new BMapGL.Marker(n))}i.addEventListener("click",function(n){s.length>=2&&E();var e=new BMapGL.Marker(new BMapGL.Point(n.latlng.lng,n.latlng.lat));i.addOverlay(e),J(n.latlng),ee(n.latlng)});const x=n=>{let e={};return z.getPoint(n,function(a){if(a){var o=new BMapGL.LocalSearch(i,{onSearchComplete:()=>{J(a)}});o.search(l);const t={addname:n,...a};s.length>=2&&E(),s.push(t),H(t),e=a}else alert("您选择的地址没有解析到结果！")}),e},ee=n=>{z.getLocation(n,function(e){const a=e.addressComponents;let o="";o=o+(a.province?a.province:""),o=o+(a.city?"-"+a.city:""),o=o+(a.district?"-"+a.district:""),o=o+(a.street?"-"+a.street:""),o=o+(a.streetNumber?"-"+a.streetNumber:"");const t={addname:o||"未知区域",...n};s.push(t),H(t)})},H=n=>{if(f)if(n){const e=`${n.addname}<br/>经度：${n.lng}，<br/>纬度：${n.lat}`;f.innerHTML+=`<p>${e}</p><hr/>`}else f.innerHTML=""},E=()=>{H(),s=[],i.clearOverlays(),ne=!1},te=()=>{var a,o,t,c;if(s.length===2){var n=[new BMapGL.Point((a=s[0])==null?void 0:a.lng,(o=s[0])==null?void 0:o.lat),new BMapGL.Point((t=s[1])==null?void 0:t.lng,(c=s[1])==null?void 0:c.lat)],e=new BMapGL.Polyline(n,{clip:!0,geodesic:!0,strokeWeight:3,visible:!0,strokeStyle:"dashed",strokeColor:"blue",strokeOpacity:1});i.addOverlay(e)}else console.log("请将点位添加至2个")};_&&_.addEventListener("click",te);D&&D.addEventListener("click",ae);Z&&Z.addEventListener("click",oe);let ne=!1;function ae(){var n,e,a,o;if(s.length===2){let t=(n=s[0])==null?void 0:n.lng,c=(e=s[1])==null?void 0:e.lng,r=(a=s[0])==null?void 0:a.lat,y=(o=s[1])==null?void 0:o.lat;const B=6371.004*((g==null?void 0:g.value)==="mile"?j:1),v=(y-r)*(Math.PI/180),M=(c-t)*(Math.PI/180),p=Math.sin(v/2)*Math.sin(v/2)+Math.cos(r*(Math.PI/180))*Math.cos(y*(Math.PI/180))*Math.sin(M/2)*Math.sin(M/2),L=2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)),u=B*L;f&&(f.innerHTML+=`<p>Haversine:${u}${g[0].value===g.value?g[0].label:g[1].label}</p>`)}else console.log("请将点位添加至2个")}function oe(){var C,$,U,V;if(s.length!==2){console.log("请将点位添加至2个");return}let n=(C=s[0])==null?void 0:C.lng,e=($=s[1])==null?void 0:$.lng,a=(U=s[0])==null?void 0:U.lat,o=(V=s[1])==null?void 0:V.lat;const t=6378137,c=6356752314245e-6,r=1/298.257223563,y=(e-n)*(Math.PI/180),B=Math.atan((1-r)*Math.tan(a*(Math.PI/180))),v=Math.atan((1-r)*Math.tan(o*(Math.PI/180))),M=Math.sin(B),p=Math.cos(B),L=Math.sin(v),u=Math.cos(v);let b=y,k,I=100,w,q,h,P,T,G,S,d,O;do{if(w=Math.sin(b),q=Math.cos(b),h=Math.sqrt(u*w*(u*w)+(p*L-M*u*q)*(p*L-M*u*q)),h===0)return 0;if(P=M*L+p*u*q,T=Math.atan2(h,P),G=p*u*w/h,S=1-G*G,d=P-2*M*L/S,O=r/16*S*(4+r*(4-3*S)),k=b,b=y+(1-O)*r*G*(T+O*h*(d+O*P*(-1+2*d*d))),I--,I===0)return NaN}while(Math.abs(b-k)>1e-12);const m=S*(t*t-c*c)/(c*c),Q=1+m/16384*(4096+m*(-768+m*(320-175*m))),A=m/1024*(256+m*(-128+m*(74-47*m))),X=A*h*(d+A/4*(P*(-1+2*d*d)-A/6*d*(-3+4*h*h)*(-3+4*d*d))),N=c*Q*(T-X)/1e3;f&&(f.innerHTML+=`Vincenty：<p>${N}公里</p>`,f.innerHTML+=`Vincenty：<p>${N*j}英里</p><hr/>`)}R&&R.addEventListener("click",E);W&&W.addEventListener("click",()=>K.open());F&&F.addEventListener("click",()=>K.close());
