(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function a(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(n){if(n.ep)return;n.ep=!0;const c=a(n);fetch(n.href,c)}})();var r=new BMapGL.Map("allmap");r.centerAndZoom(new BMapGL.Point(116.40396298757886,39.91511908708907),5);r.enableScrollWheelZoom(!0);r.setMapType(BMAP_EARTH_MAP);const R=.621371192237;var W=new BMapGL.Geocoder;const d=document.querySelector("#latlngs"),k=document.querySelector("#drawLine"),Z=document.querySelector("#distanceHaversine"),D=document.querySelector("#distanceVincenty");let o=[];var F=new BMapGL.Autocomplete({input:"suggestId",location:r});let l="";F.addEventListener("onconfirm",function(e){var t=e.item.value;console.log(e,"3333"),l=l+(t.city?t.city:""),l=l+(t.district?"-"+t.district:""),l=l+(t.street?"-"+t.street:""),l=l+(t.business?"-"+t.business:""),l=l+(t.streetNumber?"-"+t.streetNumber:""),Q(l)});F.addEventListener("onhighlight",function(e){e.fromitem.value,console.log("value",e.fromitem)});function K(e){const t=document.querySelector("#complete");(t==null?void 0:t.checked)===!0&&(r.centerAndZoom(e,12),r.addOverlay(new BMapGL.Marker(e)))}r.addEventListener("click",function(e){o.length>=2&&j();var t=new BMapGL.Marker(new BMapGL.Point(e.latlng.lng,e.latlng.lat));r.addOverlay(t),K(e.latlng),X(e.latlng)});const Q=e=>{let t={};return W.getPoint(e,function(a){if(a){var s=new BMapGL.LocalSearch(r,{onSearchComplete:()=>{console.log("point",a),K(a)}});s.search(l);const n={addname:e,...a};o.length>=2&&j(),o.push(n),U(n),t=a}else alert("您选择的地址没有解析到结果！")}),t},X=e=>{W.getLocation(e,function(t){const a=t.addressComponents;let s="";s=s+(a.province?a.province:""),s=s+(a.city?"-"+a.city:""),s=s+(a.district?"-"+a.district:""),s=s+(a.street?"-"+a.street:""),s=s+(a.streetNumber?"-"+a.streetNumber:"");const n={addname:s||"未知区域",...e};o.push(n),U(n)})},U=e=>{if(d)if(e){const t=`${e.addname}<br/>经度：${e.lng}，<br/>纬度：${e.lat}`;d.innerHTML+=`<p>${t}</p><hr/>`}else d.innerHTML=""},j=()=>{U(),o=[],r.clearOverlays(),$=!1,E=!1},Y=()=>{var a,s,n,c;if(o.length===2){var e=[new BMapGL.Point((a=o[0])==null?void 0:a.lng,(s=o[0])==null?void 0:s.lat),new BMapGL.Point((n=o[1])==null?void 0:n.lng,(c=o[1])==null?void 0:c.lat)],t=new BMapGL.Polyline(e,{clip:!1,geodesic:!0,strokeWeight:3,visible:!0});r.addOverlay(t)}else console.log("请将点位添加至2个")};k&&k.addEventListener("click",Y);Z&&Z.addEventListener("click",x);D&&D.addEventListener("click",tt);let E=!1,$=!1;function x(){var e,t,a,s;if(o.length===2){if(!E){let n=(e=o[0])==null?void 0:e.lng,c=(t=o[1])==null?void 0:t.lng,u=(a=o[0])==null?void 0:a.lat,b=(s=o[1])==null?void 0:s.lat;const B=6371,f=(b-u)*(Math.PI/180),h=(c-n)*(Math.PI/180),L=Math.sin(f/2)*Math.sin(f/2)+Math.cos(u*(Math.PI/180))*Math.cos(b*(Math.PI/180))*Math.sin(h/2)*Math.sin(h/2),w=2*Math.atan2(Math.sqrt(L),Math.sqrt(1-L)),g=B*w;console.log("distance",g),d&&(d.innerHTML+=`<p>${g}公里</p>`,d.innerHTML+=`<p>${g*R}英里</p><hr/>`),E=!0}}else console.log("请将点位添加至2个")}function tt(){var e,t,a,s;if(o.length!==2){console.log("请将点位添加至2个");return}if(!$){let n=(e=o[0])==null?void 0:e.lng,c=(t=o[1])==null?void 0:t.lng,u=(a=o[0])==null?void 0:a.lat,b=(s=o[1])==null?void 0:s.lat;const B=6378137,f=6356752314245e-6,h=1/298.257223563,L=(c-n)*(Math.PI/180),w=Math.atan((1-h)*Math.tan(u*(Math.PI/180))),g=Math.atan((1-h)*Math.tan(b*(Math.PI/180))),S=Math.sin(w),G=Math.cos(w),H=Math.sin(g),p=Math.cos(g);let y=L,C,V=100,q,A,m,v,N,O,P,i,I;do{if(q=Math.sin(y),A=Math.cos(y),m=Math.sqrt(p*q*(p*q)+(G*H-S*p*A)*(G*H-S*p*A)),m===0)return 0;if(v=S*H+G*p*A,N=Math.atan2(m,v),O=G*p*q/m,P=1-O*O,i=v-2*S*H/P,I=h/16*P*(4+h*(4-3*P)),C=y,y=L+(1-I)*h*O*(N+I*m*(i+I*v*(-1+2*i*i))),V--,V===0)return NaN}while(Math.abs(y-C)>1e-12);const M=P*(B*B-f*f)/(f*f),z=1+M/16384*(4096+M*(-768+M*(320-175*M))),T=M/1024*(256+M*(-128+M*(74-47*M))),J=T*m*(i+T/4*(v*(-1+2*i*i)-T/6*i*(-3+4*m*m)*(-3+4*i*i))),_=f*z*(N-J)/1e3;d&&(d.innerHTML+=`<p>${_}公里</p>`,d.innerHTML+=`<p>${_*R}英里</p><hr/>`),$=!0}}
